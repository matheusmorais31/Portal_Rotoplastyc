<!-- documentos/templates/documentos/listar_documentos.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}Documentos{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/listar_documentos.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <h1>Documentos</h1>

    <!-- Botão para criar novo documento -->
    <div class="icons-bar">
        <a href="{% url 'documentos:criar_documento' %}" class="icon-link">
            <img src="{% static 'images/add-document-icon.png' %}" alt="Adicionar Documento" class="icon">
        </a>
    </div>

    <div class="document-list">
        {% for documento in documentos %}
        <div class="document-container">
            <div class="document-item">
                <div class="document-info">
                    <strong>Nome:</strong> {{ documento.nome }}<br>
                    <strong>Revisão:</strong> {{ documento.revisao }}<br>
                    <strong>Categoria:</strong> {{ documento.categoria.nome }}<br>
                    <strong>Aprovado por Aprovador 1:</strong> {{ documento.aprovado_por_aprovador1|yesno:"Sim,Não" }}<br>
                    <strong>Aprovado por Aprovador 2:</strong> {{ documento.aprovado_por_aprovador2|yesno:"Sim,Não" }}<br>
                </div>
                <div class="document-actions">
                    <!-- Botão para visualizar o documento -->
                    <a href="{% url 'documentos:visualizar_documento' documento.id %}" class="action-icon">
                        <img src="{% static 'images/view-icon.png' %}" alt="Visualizar">
                    </a>

                    <!-- Botões de aprovação -->
                    {% if perms.documentos.can_approve %}
                    {% if user == documento.aprovador1 and not documento.aprovado_por_aprovador1 %}
                            <a href="{% url 'documentos:aprovar_documento' documento.id %}" class="action-icon">
                                <img src="{% static 'images/approve-icon.png' %}" alt="Aprovar">
                            </a>
                        {% elif user == documento.aprovador2 and documento.aprovado_por_aprovador1 and not documento.aprovado_por_aprovador2 %}
                            <a href="{% url 'documentos:aprovar_documento' documento.id %}" class="action-icon">
                                <img src="{% static 'images/approve-icon.png' %}" alt="Aprovar">
                            </a>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <p>Nenhum documento encontrado.</p>
        {% endfor %}
    </div>
</div>

<!-- Inclua o arquivo JavaScript, se houver -->
{% endblock %}
